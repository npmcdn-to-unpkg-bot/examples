C=[0.0 0.0 0.0;
0.0 4.0 2.0;
1.0 8.0 4.0;
2.0 15.0 9.0;
5.0 28.4 18.0;
8.0 42.0 25.0;
14.0 53.0 35.0;
23.0 65.0 45.0;
30.0 72.0 52.0;
38.0 77.0 59.0;
48.0 83.0 69.0;
62.0 90.0 80.0;
71.0 93.0 86.0;
80.0 96.0 90.0;
88.0 98.0 94.0;
100.0 100.0 100.0;
];
X=[1.0;
1.0;
1.0;
1.0;
1.0;
];
A=[0.003063960168517809 0.0030821917808219177 0.002358490566037736 0.0030402837598175834 0.0032025620496397116;
0.02566066641133665 0.007534246575342466 0.009827044025157234 0.006587281479604763 0.02642113690952762;
0.1520490233626963 0.05993150684931507 0.11595911949685535 0.00734735241955916 0.1321056845476381;
0.40903868249712755 0.3424657534246575 0.4264937106918239 0.010640993159361541 0.26220976781425137;
0.8716966679433167 0.6893835616438356 0.6682389937106918 0.010640993159361541 0.399519615692554;
0.967828418230563 0.8359589041095891 0.857311320754717 0.011401064099315936 0.5796637309847877;
0.9892761394101877 0.9643835616438357 0.982311320754717 0.03166962249809983 0.8338670936749399;
0.9946380697050938 0.9986301369863014 0.994496855345912 0.07626045097542437 0.9591673338670936;
1.0 1.0 0.9996069182389937 0.16822903470990627 0.9999999999999999;
1.0 1.0 1.0 0.3096022295414239 0.9999999999999999;
1.0 1.0 1.0 0.5665062072460096 0.9999999999999999;
1.0 1.0 1.0 0.8576133772485433 0.9999999999999999;
1.0 1.0 1.0 0.9622498099822651 0.9999999999999999;
1.0 1.0 1.0 0.9989865720800609 0.9999999999999999;
1.0 1.0 1.0 1.0 0.9999999999999999;
1.0 1.0 1.0 1.0 0.9999999999999999;
];
L=[0.0;
2.0;
4.0;
9.0;
18.0;
25.0;
35.0;
45.0;
52.0;
59.0;
69.0;
80.0;
86.0;
90.0;
94.0;
100.0;
];

MM=[4.6;
0.0;
9.4;
49.1;
36.8;
];
MM1=MM*100/sum(MM);

X1=lsqnonneg(A,L);
X2=X1*100/sum(X1);
X3=A*X2;
A1=A*100;
hold on;
plot(A1(:,1), 'color','k', 'linestyle', '--', 'linewidth', 4);
plot(A1(:,2), 'color','r', 'linestyle', '--', 'linewidth', 4);
plot(A1(:,3), 'color','g', 'linestyle', '--', 'linewidth', 4);
plot(A1(:,4), 'color','b', 'linestyle', '--', 'linewidth', 4);
plot(A1(:,5), 'color','m', 'linestyle', '--', 'linewidth', 4);
plot(C(:,1), 'color','r', 'linewidth', 4);
plot(C(:,2), 'color','r', 'linewidth', 4);
plot(C(:,3), 'color','b', 'linewidth', 4);
plot(X3, 'color','g', 'linewidth', 4);

xt=abs(C(:,3));
xx=abs(A*X2-xt);
xy=abs(A*MM1-xt);

abs(xx)-abs(xy)
